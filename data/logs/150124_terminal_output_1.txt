/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/bin/python /Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/src/mwe_metaphor/main.py 0 1 0 0
mps
+++ train DistilBERT +++
Some weights of DistilBertForTokenClassification were not initialized from the model checkpoint at distilbert-base-german-cased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
  0%|          | 0/1233 [00:00<?, ?it/s]You're using a DistilBertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
 33%|███▎      | 411/1233 [20:30<35:18,  2.58s/it]
  0%|          | 0/10 [00:00<?, ?it/s]
 20%|██        | 2/10 [00:03<00:14,  1.85s/it]
 30%|███       | 3/10 [00:07<00:18,  2.59s/it]
 40%|████      | 4/10 [00:10<00:17,  2.98s/it]
 50%|█████     | 5/10 [00:14<00:16,  3.21s/it]
 60%|██████    | 6/10 [00:18<00:13,  3.37s/it]
 70%|███████   | 7/10 [00:22<00:10,  3.48s/it]
 80%|████████  | 8/10 [00:25<00:07,  3.53s/it]
 90%|█████████ | 9/10 [00:29<00:03,  3.56s/it]
100%|██████████| 10/10 [00:30<00:00,  2.96s/it]/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: no_metaphor seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: is_metaphor seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
{'eval_loss': 0.0038683696184307337, 'eval_precision': 0.6491416309012875, 'eval_recall': 0.44881305637982194, 'eval_f1': 0.5307017543859649, 'eval_accuracy': 0.9700880153530541, 'eval_runtime': 36.1789, 'eval_samples_per_second': 16.64, 'eval_steps_per_second': 0.276, 'epoch': 1.0}

 33%|███▎      | 411/1233 [21:06<35:18,  2.58s/it]
100%|██████████| 10/10 [00:32<00:00,  2.96s/it]
 41%|████      | 500/1233 [25:33<36:18,  2.97s/it]{'loss': 0.0132, 'learning_rate': 2e-05, 'epoch': 1.22}
 67%|██████▋   | 822/1233 [47:22<16:58,  2.48s/it]
  0%|          | 0/10 [00:00<?, ?it/s]
 20%|██        | 2/10 [00:03<00:14,  1.77s/it]
 30%|███       | 3/10 [00:07<00:17,  2.51s/it]
 40%|████      | 4/10 [00:10<00:17,  2.91s/it]
 50%|█████     | 5/10 [00:14<00:15,  3.14s/it]
 60%|██████    | 6/10 [00:17<00:13,  3.29s/it]
 70%|███████   | 7/10 [00:21<00:10,  3.37s/it]
 80%|████████  | 8/10 [00:24<00:06,  3.43s/it]
 90%|█████████ | 9/10 [00:28<00:03,  3.48s/it]
100%|██████████| 10/10 [00:30<00:00,  2.89s/it]/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: no_metaphor seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: is_metaphor seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))

 67%|██████▋   | 822/1233 [47:58<16:58,  2.48s/it]
100%|██████████| 10/10 [00:31<00:00,  2.89s/it]
                                               {'eval_loss': 0.0029762142803519964, 'eval_precision': 0.7644521138912856, 'eval_recall': 0.6572700296735905, 'eval_f1': 0.7068209014758675, 'eval_accuracy': 0.9788233737012773, 'eval_runtime': 35.3002, 'eval_samples_per_second': 17.054, 'eval_steps_per_second': 0.283, 'epoch': 2.0}
 81%|████████  | 1000/1233 [56:35<11:15,  2.90s/it]{'loss': 0.003, 'learning_rate': 6.35743519781719e-06, 'epoch': 2.43}
100%|██████████| 1233/1233 [1:07:47<00:00,  2.48s/it]
  0%|          | 0/10 [00:00<?, ?it/s]
 20%|██        | 2/10 [00:03<00:14,  1.79s/it]
 30%|███       | 3/10 [00:07<00:17,  2.52s/it]
 40%|████      | 4/10 [00:10<00:17,  2.92s/it]
 50%|█████     | 5/10 [00:14<00:15,  3.14s/it]
 60%|██████    | 6/10 [00:17<00:13,  3.28s/it]
 70%|███████   | 7/10 [00:21<00:10,  3.37s/it]
 80%|████████  | 8/10 [00:24<00:06,  3.43s/it]
 90%|█████████ | 9/10 [00:28<00:03,  3.47s/it]
100%|██████████| 10/10 [00:30<00:00,  2.92s/it]/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: no_metaphor seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: is_metaphor seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))

100%|██████████| 1233/1233 [1:08:22<00:00,  2.48s/it]
100%|██████████| 10/10 [00:31<00:00,  2.92s/it]
                                               {'eval_loss': 0.002803628332912922, 'eval_precision': 0.7308567096285065, 'eval_recall': 0.7151335311572701, 'eval_f1': 0.722909636295463, 'eval_accuracy': 0.9792866124015618, 'eval_runtime': 35.425, 'eval_samples_per_second': 16.994, 'eval_steps_per_second': 0.282, 'epoch': 3.0}
100%|██████████| 1233/1233 [1:08:25<00:00,  3.33s/it]
{'train_runtime': 4105.1854, 'train_samples_per_second': 4.8, 'train_steps_per_second': 0.3, 'train_loss': 0.007004120054036161, 'epoch': 3.0}
+++ start prediction with fine-tuned model +++
Ignoring invalid subfolder format: distilbert-base-german-cased
Ignoring invalid subfolder format: distilbert-base-german-cased
/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: no_metaphor seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/seqeval/metrics/sequence_labeling.py:171: UserWarning: is_metaphor seems not to be NE tag.
  warnings.warn('{} seems not to be NE tag.'.format(chunk))
epoch 0: precision=0.26032315978456017 recall=0.3318077803203661 f1_score=0.2917505030181086 accuracy=0.9491525423728814
epoch 1: precision=0.26032315978456017 recall=0.3318077803203661 f1_score=0.2917505030181086 accuracy=0.9491525423728814
average over 2 epochs: (0.9491525423728814, 0.3318077803203661, 0.26032315978456017, 0.2917505030181086)

Process finished with exit code 0
