mps
+++ train BERT with GNC and predict +++
There are 252 entries in the test dataset for metaphor: 
                                     _id          verb  ... verb_idx  label
0  fb56e991-ea32-45a3-b918-ae7e253b4c7e        kommen  ...       27      0
1  466d0e5e-262c-4097-83eb-7a50812140d1      begegnen  ...       32      0
2  ef12b6e2-5196-469d-8299-b70ec56271a1     gestalten  ...       33      0
3  fde9b105-2b13-4d70-b340-7ab15e7a46a6  hereinkommen  ...       31      0
4  b933714f-c1fb-42a2-9fd6-79fe31cfa02f     auslaufen  ...       10      0

[5 rows x 5 columns]
MAX_LEN = 90
len of sents in mwe adj processing 6568
len(sentences)=252
max_len of tokenized texts: 105
fold number 1:

Epoch:   0%|          | 0/1 [00:00<?, ?it/s]Train loss: 0.7041508385113308

Epoch: 100%|██████████| 1/1 [00:19<00:00, 19.38s/it]
Epoch: 100%|██████████| 1/1 [00:19<00:00, 19.38s/it]
scores.accuracy()=0.5384615384615384
scores.precision_recall_fscore()=(0.5384615384615384, 0.5384615384615384, 0.5384615384615384)
fold number 2:

Epoch:   0%|          | 0/1 [00:00<?, ?it/s]Train loss: 0.7021851284163338
scores.accuracy()=0.38461538461538464
scores.precision_recall_fscore()=(0.5072463768115942, 0.5032679738562091, 0.35)

Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.32s/it]
Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.32s/it]
fold number 3:

Epoch:   0%|          | 0/1 [00:00<?, ?it/s]Train loss: 0.6985648657594409
scores.accuracy()=0.6
scores.precision_recall_fscore()=(0.5476190476190476, 0.5416666666666666, 0.5404411764705883)

Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.28s/it]
Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.28s/it]

Epoch:   0%|          | 0/1 [00:00<?, ?it/s]fold number 4:
Train loss: 0.6907659726483482

Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.04s/it]
Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.04s/it]
scores.accuracy()=0.52
/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
scores.precision_recall_fscore()=(0.26, 0.5, 0.34210526315789475)
  _warn_prf(average, modifier, msg_start, len(result))

Epoch:   0%|          | 0/1 [00:00<?, ?it/s]fold number 5:
Train loss: 0.6922553351947239
scores.accuracy()=0.44
scores.precision_recall_fscore()=(0.45588235294117646, 0.461038961038961, 0.4318181818181818)

Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.08s/it]
Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.08s/it]

Epoch:   0%|          | 0/1 [00:00<?, ?it/s]fold number 6:
Train loss: 0.6901584395340511
scores.accuracy()=0.48
scores.precision_recall_fscore()=(0.24, 0.5, 0.32432432432432434)

Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.41s/it]
Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.41s/it]
/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))

Epoch:   0%|          | 0/1 [00:00<?, ?it/s]fold number 7:
Train loss: 0.6992841064929962

Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.24s/it]
Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.24s/it]
scores.accuracy()=0.52
scores.precision_recall_fscore()=(0.5147058823529411, 0.5128205128205128, 0.49999999999999994)
fold number 8:

Epoch:   0%|          | 0/1 [00:00<?, ?it/s]Train loss: 0.7001811734267643
scores.accuracy()=0.48
scores.precision_recall_fscore()=(0.4807692307692308, 0.4807692307692308, 0.48000000000000004)

Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.13s/it]
Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.13s/it]

Epoch:   0%|          | 0/1 [00:00<?, ?it/s]fold number 9:
Train loss: 0.7045169855867114
scores.accuracy()=0.4
scores.precision_recall_fscore()=(0.2, 0.5, 0.28571428571428575)

Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.11s/it]
Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.11s/it]
/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/Users/christineschafer/Documents/Uni-Kram/Masterarbeit/Repos/metaphor_in_political_speeches/venv/lib/python3.10/site-packages/sklearn/metrics/_classification.py:1471: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
fold number 10:

Epoch:   0%|          | 0/1 [00:00<?, ?it/s]Train loss: 0.692055629832404
scores.accuracy()=0.6
scores.precision_recall_fscore()=(0.5543478260869565, 0.5166666666666667, 0.45175438596491224)

Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.22s/it]
Epoch: 100%|██████████| 1/1 [00:18<00:00, 18.22s/it]
K-fold cross-validation results:
Accuracy: 0.4963076923076922
Precision: 0.42990322550424853
Recall: 0.5054691550279785
F-score: 0.4244619155911725
####
recorded_results_per_fold= [(0.5384615384615384, 0.5384615384615384, 0.5384615384615384, 0.5384615384615384), (0.38461538461538464, 0.5072463768115942, 0.5032679738562091, 0.35), (0.6, 0.5476190476190476, 0.5416666666666666, 0.5404411764705883), (0.52, 0.26, 0.5, 0.34210526315789475), (0.44, 0.45588235294117646, 0.461038961038961, 0.4318181818181818), (0.48, 0.24, 0.5, 0.32432432432432434), (0.52, 0.5147058823529411, 0.5128205128205128, 0.49999999999999994), (0.48, 0.4807692307692308, 0.4807692307692308, 0.48000000000000004), (0.4, 0.2, 0.5, 0.28571428571428575), (0.6, 0.5543478260869565, 0.5166666666666667, 0.45175438596491224)]
len(set(recorded_results_per_fold))= 10
